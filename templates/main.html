<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Flag Game</title>
        <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='styles/background.css') }}">
        <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='styles/main.css') }}">
        <script src="{{ url_for('static', filename='scripts/main.js') }}" defer></script>
    </head>
    </head>
    <body>
        <section> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> 
            <div class="score">
                <h3 style="margin-bottom: 10px;">{{ logged_in_uname }}</h3>
                {% if high_score != 0 %}
                    <p style="margin-bottom: 10px; font-weight: bold;">High Score: {{ high_score }} </p>
                {% endif %}
                <p style="margin-bottom: 10px;">Flags: {{ flag_num }}/253 </p>
                <p>Score: {{ score }}</p>
                <form method="post">
                    <input type="hidden" name="form_type" value="game_submit">
                    <input type="hidden" name="current_score" id="current_score" value="{{ score }}">
                    <input type="submit" value="Submit Game" class="score_submit_button">
                </form>
            </div>
            <div class="scoreboard">
                <h3><a href="{{ url_for('scoreboard') }}" style="text-decoration: none;">Scoreboard</a></h3>
            </div>
            {% if answer != "Blank" %}
                <div class="answer">
                    {% if answer == "Correct!" %}
                        <h3 style="color:#008000">{{ answer }}</h3>
                    {% elif answer == "New Game Started!" %}
                        <h3 style="color:#3f60cc">{{ answer }}</h3>
                    {% else %}
                        <h3 style="color:#ff0000">{{ answer }}</h3>
                    {% endif %}
                </div>
            {% endif %}
            <img src="{{ url_for('static', filename='flags/' + flag_image) }}">
            <form autocomplete="off" method="post" class="flag_form">
                <input type="hidden" name="form_type" value="flag_guess">
                <div class="autocomplete" style="width:300px;">
                  <input id="myInput" type="text" name="selectedflag" placeholder="Country" >
                </div>
                <input type="submit" id="submitButton"autofocus>
            </form>              
            <script>
                document.addEventListener("DOMContentLoaded", function() {
                  // Fetch countries from Flask route and initialize autocomplete
                  fetch('/countries')
                    .then(response => {
                      if (!response.ok) {
                        throw new Error(`HTTP error! Status: ${response.status}`);
                      }
                      return response.json();
                    })
                    .then(data => {
                      var countries = data;
                      var submitButton = document.getElementById("submitButton");
                      autocomplete(document.getElementById("myInput"), countries, submitButton);
                    })
                    .catch(error => {
                      console.error('Fetch error:', error);
                    });
                });
            </script>
        </section>
    </body>
</html>